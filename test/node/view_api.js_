//
var Relax = require('../../');

// describe('Relax', function(){
//     describe('view function', function(){
//         it('should be setted', function(done){
//             // здесь - проверка opts, а должно быть _view; и нужно создавать db etc, а не использовать готовые;
//             var relax = new Relax;
//             relax.set({dbname:'stuff', ddocname:'stuff', viewname:'byLSh'});
//             relax.dbname.should.equal("stuff");
//             relax.ddocname.should.equal("stuff");
//             relax.viewname.should.equal("byLSh");
//             relax.pathname.should.equal('http://localhost:5984/stuff/_design/stuff/_view/byLSh');
//             true.should.be.true;
//             done();
//         })
//     })
// })

describe('Relax', function(){
    describe('parsePath by regexp', function(){
        it('should match dbname', function(done){
            var relax = new Relax('http://localhost:5984/stuff/_design/foo/_view/bar/');
            relax.hostname.should.equal("localhost");
            relax.dbname.should.equal("stuff");
            done();
        })
        it('should match viewname', function(done){
            var relax = new Relax('http://localhost:5984/stuff/_design/foo/_view/bar/');
            relax.dbname.should.equal("stuff");
            relax.ddocname.should.equal("foo");
            relax.viewname.should.equal("bar");
            done();
        })
        it('should match showname', function(done){
            var relax = new Relax('http://localhost:5984/stuff/_design/foo/_show/bar/');
            relax.dbname.should.equal("stuff");
            relax.ddocname.should.equal("foo");
            relax.showname.should.equal("bar");
            done();
        })
        it('should match the same w/o slash', function(done){
            var relax = new Relax('http://localhost:5984/stuff/_design/foo/_show/bar');
            relax.dbname.should.equal("stuff");
            relax.ddocname.should.equal("foo");
            relax.showname.should.equal("bar");
            done();
        })
    })
})
